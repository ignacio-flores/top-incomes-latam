areas = "US", # United States
perc = c("p10p100", "p50p100", "p90p100", "p99p100", "p99.9p100")
)
# Keep the value for 1970 in a separate data.frame
data1970 <- data %>% filter(year == 1970) %>%
rename(value1970 = value) %>%
select(-year)
library(wid)
library(knitr)
library(tidyverse)
data <- download_wid(
indicators = "shweal", # Shares of personal wealth
areas = "FR", # In France
perc = c("p90p100", "p99p100") # Top 1% and top 10%
)
library(ggplot2)
library(scales)
ggplot(data) +
geom_line(aes(x = year, y = value, color = percentile)) +
ylab("top share") +
scale_y_continuous(label = percent) +
scale_color_discrete(labels = c("p90p100" = "top 10%", "p99p100" = "top 1%")) +
ggtitle("Top 1% and top 10% personal wealth shares in France, 1800-2015")
library(tidyverse)
data <- download_wid(
indicators = "tptinc", # Thresholds of pre-tax national income
areas = "US", # United States
perc = c("p10p100", "p50p100", "p90p100", "p99p100", "p99.9p100")
)
# Keep the value for 1970 in a separate data.frame
data1970 <- data %>% filter(year == 1970) %>%
rename(value1970 = value) %>%
select(-year)
# Divide series by the reference year (1970)
data <- merge(data, data1970, by = c("country", "percentile")) %>%
mutate(value = 100*value/value1970)
ggplot(data) +
geom_line(aes(x = year, y = value, color = percentile)) +
ylab("1970 = 100") +
scale_color_discrete(
labels = c("p10p100" = "P10", "p50p100" = "P50", "p90p100" = "P90",
"p99p100" = "P99", "p99.9p100" = "P99.9")
) +
ggtitle("Divergence of pre-tax national income in the United States")
View(data)
data <- download_wid(
indicators = "sptinc", # Shares of pre-tax national income
areas = "US", # In the United States
years = 2010:2015, # Time period: 2010-2015
perc = "p99p100", # Top 1% only
metadata = TRUE # Also request metadata
)
data <- wid::download_wid(
indicators = "sptinc", # Shares of pre-tax national income
areas = "US", # In the United States
years = 2010:2015, # Time period: 2010-2015
perc = "p99p100", # Top 1% only
metadata = TRUE # Also request metadata
)
traceback()
data <- wid::download_wid(
indicators = "sptinc", # Shares of pre-tax national income
areas = "US", # In the United States
years = 2010:2015, # Time period: 2010-2015
perc = "p99p100", # Top 1% only
metadata = TRUE # Also request metadata
)
source("~/.active-rstudio-document", echo=TRUE)
traceback()
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/Library/CloudStorage/Dropbox/stats_coordination/wid-tool-test.R", echo=TRUE)
library(plyr)
source("~/.active-rstudio-document", echo=TRUE)
packageVersion("plyr")
?"dlply"
devtools::install_github("world-inequality-database/wid-r-tool")
source("~/.active-rstudio-document", echo=TRUE)
library(devtools)
devtools::install_github("world-inequality-database/wid-r-tool")
library(wid)
source("~/.active-rstudio-document", echo=TRUE)
library(wid)
?wid_age_codes
??wid_age_codes
?wid_population_codes
devtools::install_github("world-inequality-database/wid-r-tool")
devtools::install_github("world-inequality-database/wid-r-tool")
devtools::install_github("world-inequality-database/wid-r-tool", force = T)
devtools::install_github("ignacio-flores/wid-r-tool")
library(wid)
?download_wid
download_wid(
areas = c("AD", "CL", "AE", "OA", "OI-MER"),
#indicators = c("sptinc", "mptinc"),
indicators = "aptinc",
years = "2020",
perc = "p0p100",
ages = "992",
#pop = "j",
metadata = T)
data <- download_wid(
areas = c("AD", "CL", "AE", "OA", "OI-MER"),
#indicators = c("sptinc", "mptinc"),
indicators = "aptinc",
years = "2020",
perc = "p0p100",
ages = "992",
#pop = "j",
metadata = T)
data <- download_wid(
areas = c("AD", "CL", "AE", "OA", "OI-MER"),
indicators = c("sptinc", "mptinc"),
indicators = "aptinc",
years = "2020",
perc = "p0p100",
ages = "992",
#pop = "j",
metadata = T)
data <- download_wid(
areas = c("AD", "CL", "AE", "OA", "OI-MER"),
indicators = c("sptinc", "mptinc"),
indicators = "aptinc",
years = "2020",
perc = "p0p100",
ages = "992",
#pop = "j",
metadata = F)
data <- download_wid(
areas = c("AD", "CL", "AE", "OA", "OI-MER"),
indicators = c("sptinc", "mptinc"),
indicators = "aptinc",
years = "2020",
perc = "p0p100",
ages = "992",
#pop = "j",
metadata = F)
library(plyr)
data <- download_wid(
areas = c("AD", "CL", "AE", "OA", "OI-MER"),
indicators = c("sptinc", "mptinc"),
indicators = "aptinc",
years = "2020",
perc = "p0p100",
ages = "992",
#pop = "j",
metadata = F)
data <- download_wid(
areas = c("AD", "CL", "AE", "OA", "OI-MER"),
#indicators = c("sptinc", "mptinc"),
indicators = "aptinc",
years = "2020",
perc = "p0p100",
ages = "992",
#pop = "j",
metadata = F)
View(data)
devtools::install_github("world-inequality-database/wid-r-tool")
rm(data)
devtools::install_github("world-inequality-database/wid-r-tool")
library(wid)
data <- download_wid(
areas = c("AD", "CL", "AE", "OA", "OI-MER"),
#indicators = c("sptinc", "mptinc"),
indicators = "aptinc",
years = "2020",
perc = "p0p100",
ages = "992",
#pop = "j",
metadata = F)
View(data)
data <- download_wid(
areas = c("AD", "CL", "AE", "OA", "OI-MER"),
#indicators = c("sptinc", "mptinc"),
indicators = "aptinc",
years = "2020",
perc = "p0p100",
ages = "992",
#pop = "j",
metadata = T)
View(data)
devtools::install_github("ignacio-flores/wid-r-tool")
library(wid)
data <- download_wid(
areas = c("AD", "CL", "AE", "OA", "OI-MER"),
#indicators = c("sptinc", "mptinc"),
indicators = "aptinc",
years = "2020",
perc = "p0p100",
ages = "992",
#pop = "j",
metadata = F)
data <- download_wid(
areas = c("AD", "CL", "AE", "OA", "OI-MER"),
#indicators = c("sptinc", "mptinc"),
indicators = "aptinc",
years = "2020",
perc = "p0p100",
ages = "992",
#pop = "j",
metadata = T)
?download_wid
devtools::install_github("ignacio-flores/wid-r-tool")
data <- download_wid(
areas = c("AD", "CL", "AE", "OA", "OI-MER"),
#indicators = c("sptinc", "mptinc"),
indicators = "aptinc",
years = "2020",
perc = "p0p100",
ages = "992",
#pop = "j",
metadata = T)
devtools::install_github("world-inequality-database/wid-r-tool")
library(wid)
?download_wid()
data <- download_wid(
areas = c("AD", "CL", "AE", "OA", "OI-MER"),
#indicators = c("sptinc", "mptinc"),
indicators = "aptinc",
years = "2020",
perc = "p0p100",
ages = "992",
#pop = "j",
metadata = T)
View(data)
data <- download_wid(
areas = c("AD", "CL", "AE", "OA", "OI-MER"),
#indicators = c("sptinc", "mptinc"),
indicators = "aptinc",
years = "2020",
perc = "p0p100",
ages = "992",
#pop = "j",
metadata = T)
data <- download_wid(
areas = c("AD", "CL", "AE", "OA", "OI-MER"),
indicators = c("sptinc", "mptinc"),
indicators = "aptinc",
years = "2020",
perc = "p0p100",
ages = "992",
#pop = "j",
metadata = T)
data <- download_wid(
areas = c("AD", "CL", "AE", "OA", "OI-MER"),
indicators = c("sptinc", "mptinc"),
indicators = "aptinc",
years = "2020",
perc = "p0p100",
ages = "992",
pop = "j",
metadata = T)
devtools::install_github("world-inequality-database/wid-r-tool")
devtools::install_github("world-inequality-database/wid-r-tool", force = T)
data <- download_wid(
areas = c("AD", "CL", "AE", "OA", "OI-MER"),
indicators = c("sptinc", "mptinc"),
indicators = "aptinc",
years = "2020",
perc = "p0p100",
ages = "992",
pop = "j",
metadata = T)
library(wid)
data <- download_wid(
areas = c("AD", "CL", "AE", "OA", "OI-MER"),
indicators = c("sptinc", "mptinc"),
indicators = "aptinc",
years = "2020",
perc = "p0p100",
ages = "992",
pop = "j",
metadata = T)
data <- download_wid(
areas = c("AD", "CL", "AE", "OA", "OI-MER"),
indicators = c("sptinc", "mptinc"),
years = "2020",
perc = "p0p100",
ages = "992",
pop = "j",
metadata = T)
View(data)
?download_wid
setwd("~/Documents/GitHub/wid-r-tool")
unlink("man", recursive = TRUE)
devtools::document()
devtools::install()
?download_wid
unlink("man", recursive = TRUE)
devtools::document()
devtools::install()
?download_wid
unlink("man", recursive = TRUE)
devtools::document()
devtools::install()
?download_wid
unlink("man", recursive = TRUE)
devtools::document()
devtools::install()
?download_wid
library(wid)
?download_wid
devtools::install_github("ignacio-flores/wid-r-tool")
library(wid)
data <- download_wid(
areas = c("AD", "CL", "AE", "OA", "OI-MER"),
indicators = c("sptinc", "mptinc"),
years = "2020",
perc = "p0p100",
ages = "992",
pop = "j",
metadata = T)
View(data)
?download_wid
?download_wid
devtools::install_github("ignacio-flores/wid-r-tool")
devtools::install_github("ignacio-flores/wid-r-tool", force = T)
library(wid)
?download_wid
devtools::install_github("world-inequality-database/gpinter")
?gpinter
library(gpinter)
library(gpinter)
devtools::install_github("world-inequality-database/gpinter")
library(gpinter)
devtools::install_github("world-inequality-database/gpinter")
library(gpinter)
?gpinter
??gpinter
?tabulation_fit
library(wid)
library(wid)
d <- download_wid(
indicators = "aptinc",
years = 2020,
areas = "FR"
)
View(d)
library(wid)
d <- download_wid(
indicators = "aptinc",
years = 2020,
areas = "FR",
perc = "p99p100",
metadata = T
)
View(d)
install.packages("RSelenium")
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
library(RSelenium)
library(dplyr)
# ---- Start Selenium in Docker ----
# This will automatically start Chrome inside a Docker container
rD <- rsDriver(browser = "chrome", chromever = NULL, verbose = FALSE)
remDr <- rD$client
load("~/Documents/GitHub/wid-r-tool/R/sysdata.rda")
api_key
load("~/Documents/GitHub/wid-r-tool/R/sysdata.rda")
api_key
load("~/Documents/GitHub/wid-r-tool/R/sysdata.rda")
load("~/.RData")
library(furrr)
library(purrr)
library(future)
library(magrittr)
library(dplyr)
library(stringr)
library(tidyr)
library(kableExtra)
library(dplyr)
library(DT)
library(htmltools)
library(htmlwidgets)
library(readODS)
library(wid)
source("../code/R/modules/make_expandable.R")
#load metadata
metavars <- read_ods("meta_variables.ods")
#use kbl to display metavars
kbl(metavars, digits = 2, format.args = list(big.mark = ',')) %>%
kable_styling(full_width = F) %>%
column_spec(1, bold = TRUE) %>%
row_spec(0, bold = TRUE)
## Downloading the reference metadata file
#It can be downloaded from https://wid.world/data/ clicking on \`\`DOWNLOAD FULL DATASET''. The files are organized by area, so they need to be put together.
#list files
meta <- list.files(path = "../wid_all_data/", pattern = "_metadata_", full.names = TRUE)
data <- list.files(path = "../wid_all_data/", pattern = "_data_", full.names = TRUE)
#define data loader function
load_data <- function(path, drop = NULL) {
df <- read.csv(path, header = TRUE, sep = ";", stringsAsFactors = FALSE, colClasses = "character")
if (!is.null(drop)) {
df <- df %>% select(-all_of(drop))
}
df <- df %>%
mutate(
sixlet = str_sub(variable, 1, 6),
onelet = str_sub(sixlet, 1, 1),
twolet = str_sub(sixlet, 2, 3)
) %>% distinct()
return(df)
}
#apply function
allmeta <- future_map_dfr(meta, ~load_data(.x))
alldata <- future_map_dfr(data, ~load_data(.x, drop =c("percentile", "year", "value")))
#show an example of metadata
example <- allmeta %>%
filter(country %in% c("US", "AU") & variable %in% c("sptinci992", "accmhni999", "aedugei992")) %>%
arrange(country, variable)
library(readr)
all_yearly_pa28 <- read_csv("Documents/GitHub/landineq/data/FR/cadastre/temp/all_yearly_pa28.csv")
View(all_yearly_pa28)
colnames(all_yearly_pa28)
rm(all_yearly_pa28)
library(readr)
working_panel_8days_all_pa28 <- read_csv("Dropbox/land_ineq_degradation/data/FR/_part_c28/working_panel_8days_all_pa28.csv")
View(working_panel_8days_all_pa28)
colnames(working_panel_8days_all_pa28)
rm(working_panel_8days_all_pa28)
library(readr)
working_panel_8days_all_pa28 <- read_csv("Documents/GitHub/landineq/data/FR/_part_c28/working_panel_8days_all_pa28.csv")
View(working_panel_8days_all_pa28)
colnames(working_panel_8days_all_pa28)
rm(working_panel_8days_all_pa28)
install.packages("RCurl")
ftp_url <- "ftp://ftp.cepal.org"
install.packages("RCurl")
file_list <- getURL(ftp_url, userpwd = "badehog_temporal2:bdt22022", ftp.use.epsv = FALSE, dirlistonly = TRUE)
library(RCurl)
file_list <- getURL(ftp_url, userpwd = "badehog_temporal2:bdt22022", ftp.use.epsv = FALSE, dirlistonly = TRUE)
file_list <- getURL(ftp_url, userpwd = "badehog_temporal2:bdt22022", ftp.use.epsv = FALSE, dirlistonly = TRUE)
ftp_url <- "ftp://ftp.cepal.org/badehog/Usuario_2"
file_list <- getURL(ftp_url, userpwd = "badehog_temporal2:bdt22022", ftp.use.epsv = FALSE, dirlistonly = TRUE)
ftp_url <- "ftp://ftp.cepal.org/badehog/Usuario_2/"
file_list <- getURL(ftp_url, userpwd = "badehog_temporal2:bdt22022", ftp.use.epsv = FALSE, dirlistonly = TRUE)
ftp_url <- "ftp://ftp.cepal.org/home/badehog/Usuario_2/"
file_list <- getURL(ftp_url, userpwd = "badehog_temporal2:bdt22022", ftp.use.epsv = FALSE, dirlistonly = TRUE)
writeLines("hello world", "a.txt")
writeLines("hello world", "b.txt")
# Compare them
file.compare("a.txt", "b.txt")
library(utils)
f2020 <- st_read("~/Dropbox/land_ineq_degradation/georeferenced_data/cadastre/FR/2020/ILOTS_ANONYMES.gpks")
library(stars)
f2020 <- st_read("~/Dropbox/land_ineq_degradation/georeferenced_data/cadastre/FR/2020/ILOTS_ANONYMES.gpks")
source("~/.active-rstudio-document", echo=TRUE)
f2019 <- st_read("~/Dropbox/land_ineq_degradation/georeferenced_data/cadastre/FR/2019/ILOTS_ANONYMES.gpkg")
library(terra)
source("~/.active-rstudio-document", echo=TRUE)
plot_pct_diff_timeseries(merged, "HH_D4_R", "HH_D4_R — % difference")
plot_pct_diff_timeseries(merged, "HH_D1_R", "HH_D1_R — % difference")
plot_pct_diff_timeseries(merged, "B3g_cei", sna_label = sna_labels["B3g_cei"])
plot_pct_diff_timeseries(merged, "D4_cei",  sna_label = sna_labels["D4_cei"])
plot_pct_diff_timeseries(merged, "B2g_cei", sna_label = sna_labels["B2g_cei"])
source("~/.active-rstudio-document", echo=TRUE)
`
library(servr)
servr::httd(dir = "~/Documents/GitHub/website-gcwealthproject")
`
`
library(servr)
servr::httd(dir = "~/Documents/GitHub/website-gcwealthproject/www")
source("~/Documents/GitHub/data-showroom/deploy-app.R", echo=TRUE)
setwd("~/Documents/GitHub/data-showroom")
source("~/Documents/GitHub/data-showroom/deploy-app.R", echo=TRUE)
source("~/Documents/GitHub/data-showroom/deploy-app.R", echo=TRUE)
popdata <- read_dta("input_data/wid_population/pops.dta")
mode <- "local"
#load packages
suppressMessages(suppressPackageStartupMessages({
required_packages <- c("openxlsx","readxl", "xlsx", "ggplot2", "haven", "magrittr", "dplyr", "readr", "janitor", "glue","tidyr", "rvest", "stringr")
options(repos = c(CRAN = "https://cloud.r-project.org"))
for (pkg in required_packages) {
if (!suppressWarnings(require(pkg, character.only = TRUE, quietly = TRUE))) {
install.packages(pkg, dependencies = TRUE)
}
library(pkg, character.only = TRUE)
}
}))
config$last_year = 2023
config$last_year <- 2023
popdata <- read_dta("input_data/wid_population/pops.dta")
setwd("~/Documents/GitHub/top-incomes-latam")
popdata <- read_dta("input_data/wid_population/pops.dta")
popdata <- read_dta("input_data/wid_population/pops.dta") %>%
select(country, year, npopul)
popdata <- read_dta("intermedi
popdata <- read_dta("input_data/wid_population/pops.dta") %>%
#bring total pop
popdata <- read_dta("input_data/wid_population/pops.dta") %>%
select(country, year, npopul) %>%
filter(country == "CHL")
View(popdata)
popdata <- read_dta("input_data/wid_population/pops.dta") %>%
select(country, year, npopul) %>%
filter(country == "CHL" & year >= 1950)
View(popdata)
popdata <- read_dta("input_data/wid_population/pops.dta") %>%
select(country, year, npopul) %>%
filter(country == "CHL" & year >= 1950) %>%
rename(totalpop_ie = `npopul`)
source("~/Documents/GitHub/top-incomes-latam/code/R/02b_clean_admin_chl.R", echo=TRUE)
source("~/Documents/GitHub/top-incomes-latam/code/R/02b_clean_admin_chl.R", echo=TRUE)
chl_pop1999 <- filter(popdata, year == 1999)
View(chl_pop1999)
source("~/Documents/GitHub/top-incomes-latam/code/R/02b_clean_admin_chl.R", echo=TRUE)
source("~/Documents/GitHub/top-incomes-latam/code/R/01b_clean_admin_bra.R", echo=TRUE)
source("~/Documents/GitHub/top-incomes-latam/code/R/01b_clean_admin_bra.R", echo=TRUE)
source("~/Documents/GitHub/top-incomes-latam/code/R/01b_clean_admin_bra.R", echo=TRUE)
